# prek configuration (https://prek.j178.dev)
# Install: uv tool install prek && prek install -f

exclude: |
  (?x)^(
      .*\{\{.*\}\}.*|     # Exclude any files with cookiecutter variables
      docs/site/.*|       # Exclude mkdocs compiled files
      \.history/.*|       # Exclude history files
      .*cache.*/.*|       # Exclude cache directories
      .*venv.*/.*|        # Exclude virtual environment directories
      docs-build/.*|      # Exclude docs-build (private deps)
  )$
fail_fast: true
default_language_version:
  python: python3.13
default_install_hook_types:
- pre-commit
- commit-msg

repos:
# Built-in prek hooks (Rust-native, zero-setup, instant)
- repo: builtin
  hooks:
  - id: check-toml
    name: âœ… toml Â· validate
  - id: check-yaml
    name: âœ… yaml Â· validate
  - id: check-json
    name: âœ… json Â· validate
  - id: trailing-whitespace
    name: ğŸ§¹ whitespace Â· trim trailing
  - id: end-of-file-fixer
    name: ğŸ§¹ eof Â· ensure newline
  - id: check-merge-conflict
    name: ğŸš« git Â· check merge conflicts
  - id: detect-private-key
    name: ğŸ”’ security Â· detect private keys
  - id: check-added-large-files
    name: ğŸ“¦ git Â· check large files

# Linting & Formatting - Python
- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.11.13
  hooks:
  - id: ruff
    name: ğŸ”§ ruff Â· lint
    types_or: [python, pyi]
    args: [--fix]
  - id: ruff-format
    name: ğŸ”§ ruff Â· format
    types_or: [python, pyi]

# Linting & Formatting - Rust
- repo: local
  hooks:
  - id: cargo-fmt
    name: ğŸ¦€ rust Â· format
    entry: cargo fmt --all --manifest-path workspaces/rust/klaw-dbase/Cargo.toml --
    language: system
    types: [rust]
    pass_filenames: false
  - id: cargo-clippy
    name: ğŸ¦€ rust Â· clippy
    entry: cargo clippy --manifest-path workspaces/rust/klaw-dbase/Cargo.toml --all-targets -- -D warnings
    language: system
    types: [rust]
    pass_filenames: false

# Data & Config Validation
- repo: https://github.com/python-jsonschema/check-jsonschema
  rev: 0.33.0
  hooks:
  - id: check-github-workflows
    name: ğŸ™ github-actions Â· validate workflows
    args: [--verbose]

# Markdown
- repo: https://github.com/hukkin/mdformat
  rev: 0.7.22
  hooks:
  - id: mdformat
    name: ğŸ“ markdown Â· format
    additional_dependencies:
    - mdformat-gfm
    - mdformat-ruff
    - mdformat-frontmatter
    - ruff

# Verify web stuff
- repo: https://github.com/biomejs/pre-commit
  rev: v2.0.0-beta.5
  hooks:
  - id: biome-check
    name: ğŸ•¸ï¸ biome Â· lint & format

# Optimize images
- repo: https://github.com/shssoichiro/oxipng
  rev: v9.1.4
  hooks:
  - id: oxipng
    name: ğŸ“¸ images Â· optimize
    args: [-o, "4", --strip, safe, --alpha]

# Dependency management
- repo: https://github.com/astral-sh/uv-pre-commit
  rev: 0.7.13
  hooks:
  - id: uv-lock
    name: ğŸ”’ uv Â· lock dependencies
